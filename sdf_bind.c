#include <dlfcn.h>
#include <stdio.h>
#include "sdf_bind.h"

SDF_OpenDevice OpenDevice = NULL;
SDF_CloseDevice CloseDevice = NULL;
SDF_OpenSession OpenSession = NULL;
SDF_CloseSession CloseSession = NULL;
SDF_GetDeviceInfo GetDeviceInfo = NULL;
SDF_GenerateRandom GenerateRandom = NULL;
SDF_GetPrivateKeyAccessRight GetPrivateKeyAccessRight = NULL;
SDF_ReleasePrivateKeyAccessRight ReleasePrivateKeyAccessRight = NULL;
SDF_ExportSignPublicKey_RSA ExportSignPublicKey_RSA = NULL;
SDF_ExportEncPublicKey_RSA ExportEncPublicKey_RSA = NULL;
SDF_GenerateKeyWithIPK_RSA GenerateKeyWithIPK_RSA = NULL;
SDF_GenerateKeyWithEPK_RSA GenerateKeyWithEPK_RSA = NULL;
SDF_ImportKeyWithISK_RSA ImportKeyWithISK_RSA= NULL;
SDF_ExportSignPublicKey_ECC ExportSignPublicKey_ECC = NULL;
SDF_ExportEncPublicKey_ECC ExportEncPublicKey_ECC = NULL;
SDF_GenerateKeyWithIPK_ECC GenerateKeyWithIPK_ECC = NULL;
SDF_GenerateKeyWithEPK_ECC GenerateKeyWithEPK_ECC = NULL;
SDF_ImportKeyWithISK_ECC ImportKeyWithISK_ECC = NULL;
SDF_GenerateAgreementDataWithECC GenerateAgreementDataWithECC = NULL;
SDF_GenerateKeyWithECC GenerateKeyWithECC = NULL;
SDF_GenerateAgreementDataAndKeyWithECC GenerateAgreementDataAndKeyWithECC = NULL;
SDF_GenerateKeyWithKEK GenerateKeyWithKEK = NULL;
SDF_ImportKeyWithKEK ImportKeyWithKEK = NULL;
SDF_DestroyKey DestroyKey = NULL;
SDF_ExternalPublicKeyOperation_RSA ExternalPublicKeyOperation_RSA = NULL;
SDF_InternalPublicKeyOperation_RSA InternalPublicKeyOperation_RSA = NULL;
SDF_InternalPrivateKeyOperation_RSA InternalPrivateKeyOperation_RSA = NULL;
SDF_ExternalVerify_ECC ExternalVerify_ECC = NULL;
SDF_InternalSign_ECC InternalSign_ECC = NULL;
SDF_InternalVerify_ECC InternalVerify_ECC = NULL;
SDF_ExternalEncrypt_ECC ExternalEncrypt_ECC = NULL;
SDF_Encrypt Encrypt = NULL;
SDF_Decrypt Decrypt = NULL;
SDF_CalculateMAC CalculateMAC = NULL;
SDF_AuthEnc AuthEnc = NULL;
SDF_AuthDec AuthDec = NULL;
SDF_EncryptInit EncryptInit = NULL;
SDF_EncryptUpdate EncryptUpdate = NULL;
SDF_EncryptFinal EncryptFinal = NULL;
SDF_DecryptInit DecryptInit = NULL;
SDF_DecryptUpdate DecryptUpdate = NULL;
SDF_DecryptFinal DecryptFinal = NULL;
SDF_CalculateMACInit CalculateMACInit = NULL;
SDF_CalculateMACUpdate CalculateMACUpdate = NULL;
SDF_CalculateMACFinal CalculateMACFinal = NULL;
SDF_AuthEncInit AuthEncInit = NULL;
SDF_AuthEncUpdate AuthEncUpdate = NULL;
SDF_AuthEncFinal AuthEncFinal = NULL;
SDF_AuthDecInit AuthDecInit = NULL;
SDF_AuthDecUpdate AuthDecUpdate = NULL;
SDF_AuthDecFinal AuthDecFinal = NULL;
SDF_HMACInit HMACInit = NULL;
SDF_HMACUpdate HMACUpdate = NULL;
SDF_HMACFinal HMACFinal = NULL;
SDF_HashInit HashInit = NULL;
SDF_HashUpdate HashUpdate = NULL;
SDF_HashFinal HashFinal = NULL;
SDF_CreateFile CreateFile = NULL;
SDF_ReadFile ReadFile = NULL;
SDF_WriteFile WriteFile = NULL;
SDF_DeleteFile DeleteFile = NULL;

/*  这里的调试验证类函数，需要软实现，以完成对上边函数的调试。 */
SDF_GenerateKeyPair_RSA GenerateKeyPair_RSA = NULL;
SDF_GenerateKeyPair_ECC GenerateKeyPair_ECC = NULL;
SDF_ExternalPrivateKeyOperation_RSA ExternalPrivateKeyOperation_RSA = NULL;
SDF_ExternalSign_ECC ExternalSign_ECC = NULL;
SDF_ExternalDecrypt_ECC ExternalDecrypt_ECC = NULL;
SDF_ExternalSign_SM9 ExternalSign_SM9 = NULL;
SDF_ExternalDecrypt_SM9 ExternalDecrypt_SM9 = NULL;
SDF_ExternalKeyEncrypt ExternalKeyEncrypt = NULL;
SDF_ExternalKeyDecrypt ExternalKeyDecrypt = NULL;
SDF_ExternalKeyEncryptInit ExternalKeyEncryptInit = NULL;
SDF_ExternalKeyDecryptInit ExternalKeyDecryptInit = NULL;
SDF_ExternalKeyHMACInit ExternalKeyHMACInit = NULL;

int sdf_bind_init(void *handle) {
    OpenDevice = (SDF_OpenDevice)dlsym(handle, "SDF_OpenDevice");
    CloseDevice = (SDF_CloseDevice)dlsym(handle, "SDF_CloseDevice");
    OpenSession = (SDF_OpenSession)dlsym(handle, "SDF_OpenSession");
    CloseSession = (SDF_CloseSession)dlsym(handle, "SDF_CloseSession");
    GetDeviceInfo = (SDF_GetDeviceInfo)dlsym(handle, "SDF_GetDeviceInfo");
    GenerateRandom = (SDF_GenerateRandom)dlsym(handle, "SDF_GenerateRandom");
    GetPrivateKeyAccessRight = (SDF_GetPrivateKeyAccessRight)dlsym(handle, "SDF_GetPrivateKeyAccessRight");
    ReleasePrivateKeyAccessRight = (SDF_ReleasePrivateKeyAccessRight)dlsym(handle, "SDF_ReleasePrivateKeyAccessRight");
    ExportSignPublicKey_RSA = (SDF_ExportSignPublicKey_RSA)dlsym(handle, "SDF_ExportSignPublicKey_RSA");
    ExportEncPublicKey_RSA = (SDF_ExportEncPublicKey_RSA)dlsym(handle, "SDF_ExportEncPublicKey_RSA");
    GenerateKeyWithIPK_RSA = (SDF_GenerateKeyWithIPK_RSA)dlsym(handle, "SDF_GenerateKeyWithIPK_RSA");
    GenerateKeyWithEPK_RSA = (SDF_GenerateKeyWithEPK_RSA)dlsym(handle, "SDF_GenerateKeyWithEPK_RSA");
    ImportKeyWithISK_RSA = (SDF_ImportKeyWithISK_RSA)dlsym(handle, "SDF_ImportKeyWithISK_RSA");
    ExportSignPublicKey_ECC = (SDF_ExportSignPublicKey_ECC)dlsym(handle, "SDF_ExportSignPublicKey_ECC");
    ExportEncPublicKey_ECC = (SDF_ExportEncPublicKey_ECC)dlsym(handle, "SDF_ExportEncPublicKey_ECC");
    GenerateKeyWithIPK_ECC = (SDF_GenerateKeyWithIPK_ECC)dlsym(handle, "SDF_GenerateKeyWithIPK_ECC");
    GenerateKeyWithEPK_ECC = (SDF_GenerateKeyWithEPK_ECC)dlsym(handle, "SDF_GenerateKeyWithEPK_ECC");
    ImportKeyWithISK_ECC = (SDF_ImportKeyWithISK_ECC)dlsym(handle, "SDF_ImportKeyWithISK_ECC");
    GenerateAgreementDataWithECC = (SDF_GenerateAgreementDataWithECC)dlsym(handle, "SDF_GenerateAgreementDataWithECC");
    GenerateKeyWithECC = (SDF_GenerateKeyWithECC)dlsym(handle, "SDF_GenerateKeyWithECC");
    GenerateAgreementDataAndKeyWithECC = (SDF_GenerateAgreementDataAndKeyWithECC)dlsym(handle, "SDF_GenerateAgreementDataAndKeyWithECC");
    GenerateKeyWithKEK = (SDF_GenerateKeyWithKEK)dlsym(handle, "SDF_GenerateKeyWithKEK");
    ImportKeyWithKEK = (SDF_ImportKeyWithKEK)dlsym(handle, "SDF_ImportKeyWithKEK");
    DestroyKey = (SDF_DestroyKey)dlsym(handle, "SDF_DestroyKey");
    ExternalPublicKeyOperation_RSA = (SDF_ExternalPublicKeyOperation_RSA)dlsym(handle, "SDF_ExternalPublicKeyOperation_RSA");
    InternalPublicKeyOperation_RSA = (SDF_InternalPublicKeyOperation_RSA)dlsym(handle, "SDF_InternalPublicKeyOperation_RSA");
    InternalPrivateKeyOperation_RSA = (SDF_InternalPrivateKeyOperation_RSA)dlsym(handle, "SDF_InternalPrivateKeyOperation_RSA");
    ExternalVerify_ECC = (SDF_ExternalVerify_ECC)dlsym(handle, "SDF_ExternalVerify_ECC");
    InternalSign_ECC = (SDF_InternalSign_ECC)dlsym(handle, "SDF_InternalSign_ECC");
    InternalVerify_ECC = (SDF_InternalVerify_ECC)dlsym(handle, "SDF_InternalVerify_ECC");
    ExternalEncrypt_ECC = (SDF_ExternalEncrypt_ECC)dlsym(handle, "SDF_ExternalEncrypt_ECC");
    Encrypt = (SDF_Encrypt)dlsym(handle, "SDF_Encrypt");
    Decrypt = (SDF_Decrypt)dlsym(handle, "SDF_Decrypt");
    CalculateMAC = (SDF_CalculateMAC)dlsym(handle, "SDF_CalculateMAC");
    AuthEnc = (SDF_AuthEnc)dlsym(handle, "SDF_AuthEnc");
    AuthDec = (SDF_AuthDec)dlsym(handle, "SDF_AuthDec");
    EncryptInit = (SDF_EncryptInit)dlsym(handle, "SDF_EncryptInit");
    EncryptUpdate = (SDF_EncryptUpdate)dlsym(handle, "SDF_EncryptUpdate");
    EncryptFinal = (SDF_EncryptFinal)dlsym(handle, "SDF_EncryptFinal");
    DecryptInit = (SDF_DecryptInit)dlsym(handle, "SDF_DecryptInit");
    DecryptUpdate = (SDF_DecryptUpdate)dlsym(handle, "SDF_DecryptUpdate");
    DecryptFinal = (SDF_DecryptFinal)dlsym(handle, "SDF_DecryptFinal");
    CalculateMACInit = (SDF_CalculateMACInit)dlsym(handle, "SDF_CalculateMACInit");
    CalculateMACUpdate = (SDF_CalculateMACUpdate)dlsym(handle, "SDF_CalculateMACUpdate");
    CalculateMACFinal = (SDF_CalculateMACFinal)dlsym(handle, "SDF_CalculateMACFinal");
    AuthEncInit = (SDF_AuthEncInit)dlsym(handle, "SDF_AuthEncInit");
    AuthEncUpdate = (SDF_AuthEncUpdate)dlsym(handle, "SDF_AuthEncUpdate");
    AuthEncFinal = (SDF_AuthEncFinal)dlsym(handle, "SDF_AuthEncFinal");
    AuthDecInit = (SDF_AuthDecInit)dlsym(handle, "SDF_AuthDecInit");
    AuthDecUpdate = (SDF_AuthDecUpdate)dlsym(handle, "SDF_AuthDecUpdate");
    AuthDecFinal = (SDF_AuthDecFinal)dlsym(handle, "SDF_AuthDecFinal");
    HMACInit = (SDF_HMACInit)dlsym(handle, "SDF_HMACInit");
    HMACUpdate = (SDF_HMACUpdate)dlsym(handle, "SDF_HMACUpdate");
    HMACFinal = (SDF_HMACFinal)dlsym(handle, "SDF_HMACFinal");
    HashInit = (SDF_HashInit)dlsym(handle, "SDF_HashInit");
    HashUpdate = (SDF_HashUpdate)dlsym(handle, "SDF_HashUpdate");
    HashFinal = (SDF_HashFinal)dlsym(handle, "SDF_HashFinal");
    CreateFile = (SDF_CreateFile)dlsym(handle, "SDF_CreateFile");
    ReadFile = (SDF_ReadFile)dlsym(handle, "SDF_ReadFile");
    WriteFile = (SDF_WriteFile)dlsym(handle, "SDF_WriteFile");
    DeleteFile = (SDF_DeleteFile)dlsym(handle, "SDF_DeleteFile");
    GenerateKeyPair_RSA = (SDF_GenerateKeyPair_RSA)dlsym(handle, "SDF_GenerateKeyPair_RSA");
    GenerateKeyPair_ECC = (SDF_GenerateKeyPair_ECC)dlsym(handle, "SDF_GenerateKeyPair_ECC");
    ExternalPrivateKeyOperation_RSA = (SDF_ExternalPrivateKeyOperation_RSA)dlsym(handle, "SDF_ExternalPrivateKeyOperation_RSA");
    ExternalSign_ECC = (SDF_ExternalSign_ECC)dlsym(handle, "SDF_ExternalSign_ECC");
    ExternalDecrypt_ECC = (SDF_ExternalDecrypt_ECC)dlsym(handle, "SDF_ExternalDecrypt_ECC");
    ExternalSign_SM9 = (SDF_ExternalSign_SM9)dlsym(handle, "SDF_ExternalSign_SM9");
    ExternalDecrypt_SM9 = (SDF_ExternalDecrypt_SM9)dlsym(handle, "SDF_ExternalDecrypt_SM9");
    ExternalKeyEncrypt = (SDF_ExternalKeyEncrypt)dlsym(handle, "SDF_ExternalKeyEncrypt");
    ExternalKeyDecrypt = (SDF_ExternalKeyDecrypt)dlsym(handle, "SDF_ExternalKeyDecrypt");
    ExternalKeyEncryptInit = (SDF_ExternalKeyEncryptInit)dlsym(handle, "SDF_ExternalKeyEncryptInit");
    ExternalKeyDecryptInit = (SDF_ExternalKeyDecryptInit)dlsym(handle, "SDF_ExternalKeyDecryptInit");
    ExternalKeyHMACInit = (SDF_ExternalKeyHMACInit)dlsym(handle, "SDF_ExternalKeyHMACInit");
    return 0;
}